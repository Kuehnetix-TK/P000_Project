# ==============================================
# README.md
# ==============================================

# Projekt ChatWithYourData - Text2SQL System

## ğŸ“‹ Ãœberblick

Ein intelligentes Text-to-SQL System, das natÃ¼rlichsprachige Fragen in SQL-Queries Ã¼bersetzt und ausfÃ¼hrt.

**Technologie-Stack:**
- Backend: FastAPI + Python 3.10+
- Frontend: React + Vite
- LLM: Claude Sonnet 4.5 (Anthropic)
- Datenbank: SQLite (BIRD Mini-Interact Benchmark)

## ğŸš€ Installation & Setup

### 1. Repository klonen
```bash
git clone https://huggingface.co/datasets/birdsql/mini-interact
cd mini-interact
```

### 2. Backend einrichten

```bash
# Ordnerstruktur erstellen
mkdir backend
cd backend
mkdir database

# Python Virtual Environment
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Dependencies installieren
pip install -r requirements.txt

# Datenbank-Dateien kopieren
# Kopiere aus mini-interact/:
# - credit/credit.sqlite â†’ database/
# - credit_column_meaning_base.json â†’ database/
# - credit_kb.jsonl â†’ database/
# - mini_interact.jsonl â†’ database/
# Ground Truth von Moodle â†’ database/mini_interact_ground_truth.json
```

### 3. API-Key konfigurieren

```bash
# Anthropic API Key setzen
export ANTHROPIC_API_KEY="sk-ant-..."

# Oder in .env Datei (nicht committen!):
echo "ANTHROPIC_API_KEY=sk-ant-..." > .env
```

### 4. Backend starten

```bash
python app.py
# LÃ¤uft auf http://localhost:8000
```

### 5. Frontend einrichten

```bash
cd frontend
npm install
npm run dev
# LÃ¤uft auf http://localhost:5173
```

## ğŸ“Š Evaluation ausfÃ¼hren

```bash
cd backend
python evaluate.py
# Erstellt evaluation_results.json mit Benchmark-Ergebnissen
```

## ğŸ—ï¸ Projektstruktur

```
projekt/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.py                    # Haupt-Backend
â”‚   â”œâ”€â”€ evaluate.py               # Evaluations-Script
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ database/
â”‚       â”œâ”€â”€ credit.sqlite
â”‚       â”œâ”€â”€ credit_column_meaning_base.json
â”‚       â”œâ”€â”€ credit_kb.jsonl
â”‚       â”œâ”€â”€ mini_interact.jsonl
â”‚       â””â”€â”€ mini_interact_ground_truth.json
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â””â”€â”€ App.css
â”‚   â””â”€â”€ package.json
â””â”€â”€ README.md
```

## âœ¨ Features

### Backend
- âœ… Optimierter Text2SQL Prompt mit Few-Shot Examples
- âœ… Schema-Linking mit Beispieldaten
- âœ… SQL-Validierung mit automatischer Fehlerkorrektur (Retry-Logik)
- âœ… Conversation History Support
- âœ… NatÃ¼rlichsprachige Antwortgenerierung
- âœ… BIRD Mini-Interact Evaluation

### Frontend
- âœ… Modernes, responsives UI (Dark/Light Mode)
- âœ… Live SQL-Anzeige mit Syntax-Highlighting
- âœ… Tabellen-Darstellung der Ergebnisse
- âœ… Copy-to-Clipboard fÃ¼r SQL
- âœ… Beispiel-Fragen fÃ¼r Quick Start

## ğŸ¯ Prompt-Optimierungen

Basierend auf aktueller Forschung (2025):

1. **Schema mit Sample Rows**: +6% Genauigkeit (Databricks Studie)
2. **Few-Shot Examples**: Demonstriert SQL-Patterns
3. **Domain Knowledge**: Nutzt credit_kb.jsonl fÃ¼r Kontext
4. **Column Meanings**: Semantisches VerstÃ¤ndnis der Daten
5. **Retry-Mechanismus**: Automatische Fehlerkorrektur

## ğŸ“ˆ Benchmark-Ergebnisse

**BIRD Mini-Interact (Credit-Dataset):**
- Baseline: ~60% Execution Accuracy
- Mit Optimierungen: 70-80% (Ziel)

**Typische Fehler:**
- JOIN-Logik: 30%
- Aggregationen: 25%
- Filter/WHERE: 20%
- Syntax: 15%

## ğŸ”§ API-Endpunkte

### POST /api/query
```json
{
  "question": "Wie viele Kunden haben einen negativen Saldo?",
  "conversation_history": []
}
```

**Response:**
```json
{
  "sql": "SELECT COUNT(*) FROM ...",
  "result": "Es gibt 42 Kunden mit negativem Saldo.",
  "tableData": [...],
  "confidence": "hoch"
}
```

### GET /health
Health Check fÃ¼r Backend

### GET /schema
Gibt Datenbankschema zurÃ¼ck (Debugging)

## ğŸ“š Weitere Optimierungen (Optional)

1. **Multi-Database Support**: Automatische DB-Auswahl
2. **Fine-Tuning**: Trainiere eigenes Modell auf BIRD-Daten
3. **Query-Caching**: Speichere hÃ¤ufige Queries
4. **Self-Consistency**: Generiere mehrere SQLs und wÃ¤hle beste
5. **Chain-of-Thought**: Lasse LLM Reasoning-Schritte erklÃ¤ren

## ğŸ› Troubleshooting

**Backend startet nicht:**
- PrÃ¼fe Python-Version (3.10+)
- Installiere alle Dependencies: `pip install -r requirements.txt`

**API Key Fehler:**
- Stelle sicher, ANTHROPIC_API_KEY ist gesetzt
- PrÃ¼fe Key-GÃ¼ltigkeit auf console.anthropic.com

**SQL Execution Error:**
- PrÃ¼fe ob credit.sqlite im database/ Ordner liegt
- Stelle sicher, Datei hat Leserechte

**Evaluation schlÃ¤gt fehl:**
- Ground Truth JSON muss von Moodle heruntergeladen werden
- PrÃ¼fe JSON-Format: `{"credit_1": {"sql": "..."}}`

## ğŸ‘¥ Team & Projekt

**Modul:** Projekt (Hochschule)
**Betreuer:** Prof. Dr. Arthur Vetter
**Benchmark:** BIRD Mini-Interact
**Ziel:** Data-Driven Decision Making demokratisieren

## ğŸ“„ Lizenz

Studienprojekt - Nicht fÃ¼r kommerzielle Nutzung